"use strict";(()=>{var e={};e.id=422,e.ids=[422],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{e.exports=require("querystring")},13641:(e,r,t)=>{t.d(r,{db:()=>s});var a=t(96330),n=t(8516);let o=globalThis,s=o.prisma??new a.PrismaClient({log:"development"===n._.NODE_ENV?["query","error","warn"]:["error"]});"production"!==n._.NODE_ENV&&(o.prisma=s)},19185:e=>{e.exports=require("dgram")},21820:e=>{e.exports=require("os")},21994:e=>{e.exports=require("domain")},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29021:e=>{e.exports=require("fs")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{e.exports=require("path")},41204:e=>{e.exports=require("string_decoder")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48719:(e,r,t)=>{t.d(r,{Tu:()=>C,jJ:()=>A,or:()=>x,q2:()=>q,ql:()=>m,qr:()=>b,xK:()=>l,xZ:()=>y,ys:()=>p,z2:()=>_,z_:()=>E});var a=t(67218);t(79130);var n=t(29021),o=t(33873),s=t.n(o),i=t(82162),c=t(8516);let d=s().join(process.cwd(),"static","gifts");function u(e){return s().join(d,e)}function f(e){return s().join(u(e),"content.json")}let l=async function(e){try{if(c._.YANDEX_ACCESS_KEY_ID&&c._.YANDEX_SECRET_ACCESS_KEY&&c._.YANDEX_BUCKET_NAME){let r=await (0,i.yk)(e);if(r)return r}let r=f(e),t=await n.promises.readFile(r,"utf-8");return JSON.parse(t)}catch(r){return console.error(`Ошибка загрузки контента подарка: ${e}`,r),null}};var p=(0,a.A)(l,"406d5606aead8a8bacfe2cdd3e85cfdd2c19db2000",null);let b=async function(e,r){try{if(c._.YANDEX_ACCESS_KEY_ID&&c._.YANDEX_SECRET_ACCESS_KEY&&c._.YANDEX_BUCKET_NAME)try{return await (0,i.yz)(e,r),!0}catch(r){console.error(`Ошибка сохранения контента в Yandex Object Storage: ${e}`,r)}let t=u(e),a=f(e);return await n.promises.mkdir(t,{recursive:!0}),await n.promises.writeFile(a,JSON.stringify(r,null,2),"utf-8"),!0}catch(r){return console.error(`Ошибка сохранения контента подарка: ${e}`,r),!1}};var E=(0,a.A)(b,"60b232e31a3e4489582c571d7d7610ac8bf38a305a",null);let _=async function(e){return e};var x=(0,a.A)(_,"40dbb6530b043238ae6a08c39b3c8036d234882809",null);let q=async function(e){try{if(c._.YANDEX_ACCESS_KEY_ID&&c._.YANDEX_SECRET_ACCESS_KEY&&c._.YANDEX_BUCKET_NAME&&await (0,i.T1)(e))return!0;let r=f(e);return await n.promises.access(r),!0}catch{return!1}};(0,a.A)(q,"40ca065a4463e8263867e3e499283bc6b495df367f",null);let A=async function(e,r,t,a){try{if(c._.YANDEX_ACCESS_KEY_ID&&c._.YANDEX_SECRET_ACCESS_KEY&&c._.YANDEX_BUCKET_NAME)return await (0,i.TU)(t,r,e,a);throw Error("Yandex Object Storage is not configured")}catch(t){throw console.error(`Ошибка сохранения файла ${r} для подарка ${e}:`,t),t}};(0,a.A)(A,"78b96f14216dbd9b99266f83758b0d01a4b1b85f54",null);let m=async function(e,r){try{let t=r?s().join(u(e),r):u(e);return(await n.promises.readdir(t)).filter(e=>!e.startsWith("."))}catch(r){return console.error(`Ошибка получения файлов подарка ${e}:`,r),[]}};(0,a.A)(m,"600a0d7df77d62b52c417650c18d18495bacd7d9b8",null);let y=async function(e){try{let r=u(e);return await n.promises.rm(r,{recursive:!0,force:!0}),!0}catch(r){return console.error(`Ошибка удаления папки подарка ${e}:`,r),!1}};var C=(0,a.A)(y,"401a0502c0665f669338aad34b336a2135500fe412",null)},55511:e=>{e.exports=require("crypto")},55591:e=>{e.exports=require("https")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},65852:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>E,routeModule:()=>f,serverHooks:()=>b,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>p});var a={};t.r(a),t.d(a,{GET:()=>u});var n=t(96559),o=t(48088),s=t(37719),i=t(32190),c=t(48719),d=t(13641);async function u(e,{params:r}){try{let{filename:e}=r,t=await d.db.gift.findUnique({where:{id:e}});if(!t)return i.NextResponse.json({error:"Gift not found"},{status:404});if(t.contentUrl)return i.NextResponse.redirect(t.contentUrl);let a=await (0,c.ys)(e);if(!a)return i.NextResponse.json({error:"Gift content not found"},{status:404});return i.NextResponse.json(a)}catch(e){return console.error("Error loading gift content:",e),i.NextResponse.json({error:"Failed to load gift content"},{status:500})}}let f=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/gift-content/[filename]/route",pathname:"/api/gift-content/[filename]",filename:"route",bundlePath:"app/api/gift-content/[filename]/route"},resolvedPagePath:"C:\\repositories\\lesya.svet\\src\\app\\api\\gift-content\\[filename]\\route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:l,workUnitAsyncStorage:p,serverHooks:b}=f;function E(){return(0,s.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:p})}},66136:e=>{e.exports=require("timers")},79428:e=>{e.exports=require("buffer")},79551:e=>{e.exports=require("url")},79646:e=>{e.exports=require("child_process")},81630:e=>{e.exports=require("http")},94735:e=>{e.exports=require("events")},95795:(e,r,t)=>{t.r(r),t.d(r,{"00ea83477a13a459fdf08fd3e6f65958e8233576fd":()=>n.xK,"401a0502c0665f669338aad34b336a2135500fe412":()=>a.xZ,"40217cf8d08e1947972106ddde22ddf43c2bb0ed41":()=>n.z2,"4066d672de5ab4d947483099099b587b8f65bca2a7":()=>n.q2,"406d0e21608895f9fa266a4fd00f7cd6825119033a":()=>n.EB,"406d5606aead8a8bacfe2cdd3e85cfdd2c19db2000":()=>a.xK,"4078492ea5b92d5fdfeed6743137880623145f68ac":()=>n.xZ,"40ca065a4463e8263867e3e499283bc6b495df367f":()=>a.q2,"40dbb6530b043238ae6a08c39b3c8036d234882809":()=>a.z2,"600a0d7df77d62b52c417650c18d18495bacd7d9b8":()=>a.ql,"60104488d5035fa6645db34d4720bc5db5ca51ebe3":()=>n.jJ,"6065a8450153a035b58e5f7c83c86ece5b2a923f4b":()=>n.ql,"60b232e31a3e4489582c571d7d7610ac8bf38a305a":()=>a.qr,"783346ae271af48396c519dd51d41fc3ec639e216f":()=>n.qr,"78b96f14216dbd9b99266f83758b0d01a4b1b85f54":()=>a.jJ});var a=t(48719),n=t(82162)},96330:e=>{e.exports=require("@prisma/client")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[447,724,267,580,41],()=>t(65852));module.exports=a})();