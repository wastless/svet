(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3698],{146:(e,t,a)=>{"use strict";a.d(t,{B:()=>function e(t,a,r,l,i){let n=s.Children.map(t,(t,i)=>{if(!s.isValidElement(t))return t;let n=t.type,o="function"==typeof n&&"string"==typeof n.displayName?n.displayName:"",c=r.includes(o)?a:{},d=t.props,h=null==d?void 0:d.children;return s.cloneElement(t,{...c,key:"".concat(l,"-").concat(i)},null!=h?e(h,a,r,l,!!(null==d?void 0:d.asChild)):void 0)});return i?null==n?void 0:n[0]:n}});var s=a(2115)},1775:(e,t,a)=>{"use strict";a.d(t,{b:()=>n});var s=a(5155),r=a(2115),l=a(9708);let i=(0,a(6694).tv)({slots:{root:["group","relative","flex","items-center","gap-2","font-styrene","md:text-paragraph-md","sm:text-paragraph-sm sm:font-bold","md:font-bold","uppercase","text-adaptive","transition-all","duration-300"],text:[],icon:["transition-transform"],underline:["absolute","bottom-0","h-[2px]","w-0","translate-y-1","transform","bg-adaptive-text","transition-all","duration-700","ease-custom","group-hover:w-1/2"],underlineLeft:["left-0"],underlineRight:["right-0"]},variants:{position:{relative:{},absolute:{root:["absolute","bottom-8","right-8","z-10"]}},iconPosition:{start:{icon:["group-hover:-translate-x-1"]},end:{icon:["group-hover:translate-x-1"]}}},defaultVariants:{position:"relative",iconPosition:"end"}}),n=r.forwardRef((e,t)=>{let{children:a,icon:r,asChild:n,className:o,position:c,iconPosition:d,...h}=e,x=n?l.DX:"button",u=i({position:c,iconPosition:d}),p=r&&(0,s.jsx)("span",{className:u.icon(),children:r});return(0,s.jsxs)(x,{ref:t,className:u.root({className:o}),...h,children:["start"===d&&p,(0,s.jsx)("span",{className:u.text(),children:a}),"end"===d&&p,(0,s.jsx)("span",{className:"".concat(u.underline()," ").concat(u.underlineLeft())}),(0,s.jsx)("span",{className:"".concat(u.underline()," ").concat(u.underlineRight())})]})});n.displayName="IconButtonRoot"},2352:(e,t,a)=>{"use strict";a.d(t,{l:()=>l,y:()=>r});var s=a(5155);a(2115);let r=e=>{let{className:t}=e;return(0,s.jsx)("div",{className:"c-spinner ".concat(t||"")})},l=()=>(0,s.jsx)("div",{className:"c-loader",children:(0,s.jsx)("div",{className:"c-loader_spinner c-spinner"})})},3330:(e,t,a)=>{"use strict";a.d(t,{HJ:()=>m,Kv:()=>u,RX:()=>h,Zj:()=>d,sw:()=>x,xj:()=>p});var s=a(2960),r=a(6715),l=a(5041),i=a(4258),n=a(2385),o=a(2115);let c={GIFTS:"gifts",GIFT:e=>["gift",e],GIFT_CONTENT:e=>["gift-content",e]};function d(){return(0,s.I)({queryKey:[c.GIFTS],queryFn:async()=>{let e=Date.now(),t=await fetch("/api/gifts?_t=".concat(e));if(!t.ok)throw Error("Ошибка загрузки подарков");return t.json()},staleTime:0,gcTime:0,refetchOnWindowFocus:!0,refetchOnMount:!0,refetchOnReconnect:!0})}function h(e){return(0,s.I)({queryKey:c.GIFT_CONTENT(e),queryFn:async()=>{let t=Date.now(),a=await fetch("/api/gift-content/".concat(e,"?_t=").concat(t));if(!a.ok)throw Error("Ошибка загрузки контента подарка ".concat(e));if(a.redirected){let t=await fetch(a.url);if(!t.ok)throw Error("Ошибка загрузки контента подарка ".concat(e," из облачного хранилища"));return t.json()}return a.json()},enabled:!!e,staleTime:0,gcTime:0,refetchOnWindowFocus:!0,refetchOnMount:!0,refetchOnReconnect:!0})}function x(e){var t;let a=(0,s.I)({queryKey:c.GIFT(e),queryFn:async()=>{let t=Date.now(),a=await fetch("/api/gifts/".concat(e,"?_t=").concat(t));if(!a.ok)throw Error("Ошибка загрузки подарка ".concat(e));return a.json()},enabled:!!e,staleTime:0,gcTime:0,refetchOnWindowFocus:!0,refetchOnMount:!0,refetchOnReconnect:!0}),r=h(e),l=(0,i.Q)(),d=a.isLoading||r.isLoading||l.isLoading,x=a.isError||r.isError||l.isError,u=a.error||r.error||l.error,p=(0,o.useMemo)(()=>{var e,t;return d||x?null:{gift:a.data,content:r.data,isAuthenticated:null==(e=l.data)?void 0:e.isAuthenticated,memoryPhoto:null==(t=a.data)?void 0:t.memoryPhoto}},[d,x,a.data,r.data,null==(t=l.data)?void 0:t.isAuthenticated]),m=(0,o.useRef)(!1);return{data:p,isLoading:d,isError:x,error:u,refetch:(0,o.useCallback)(async()=>{m.current||(console.log("\uD83D\uDD04 Invalidating cache for gift ".concat(e)),(0,n.Mb)(e),m.current=!0),await Promise.all([a.refetch(),r.refetch()]),setTimeout(()=>{m.current=!1},500)},[e,a,r])}}function u(){let e=(0,r.jE)();return(0,l.n)({mutationFn:async e=>{let t=await fetch("/api/gifts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Ошибка при создании подарка");return t.json()},onSuccess:()=>{e.invalidateQueries({queryKey:[c.GIFTS]}),(0,n.Mb)()}})}function p(e){let t=(0,r.jE)();return(0,l.n)({mutationFn:async t=>{if(!e)throw Error("ID подарка не указан");let a=await fetch("/api/gifts/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error((await a.json()).error||"Ошибка при обновлении подарка");return a.json()},onSuccess:a=>{e&&(t.setQueryData(c.GIFT(e),a),t.invalidateQueries({queryKey:[c.GIFTS]}),t.invalidateQueries({queryKey:c.GIFT_CONTENT(e)}),(0,n.Mb)(e))}})}function m(){let e=(0,r.jE)();return(0,l.n)({mutationFn:async e=>{if(!(await fetch("/api/gifts/".concat(e),{method:"DELETE"})).ok)throw Error("Ошибка при удалении подарка");return e},onSuccess:t=>{e.invalidateQueries({queryKey:[c.GIFTS]}),e.removeQueries({queryKey:c.GIFT(t)}),e.removeQueries({queryKey:c.GIFT_CONTENT(t)}),(0,n.Mb)(t)}})}},3738:(e,t,a)=>{Promise.resolve().then(a.bind(a,8482))},4346:(e,t,a)=>{"use strict";a.d(t,{DG:()=>l,H6:()=>r,l$:()=>s});let s={START_DATE:"2025-07-01",CYCLE_LENGTH:365},r={TARGET_DATE:"2025-08-01",UPDATE_INTERVAL:1e3},l=["Hi","Hey","Hola","Bonjour","Hallo","Ciao","Ol\xe1","Czesc","Privet","Merhaba","Salam","Shalom","Ni hao","Namaste","Sawadee","Halo","Jambo","Yia sou","Hall\xf3","Hej","Hej","Ahoj","Hell\xf3"]},4629:(e,t,a)=>{"use strict";a.d(t,{E$:()=>i,HQ:()=>p,IJ:()=>n,fl:()=>r,kt:()=>o,lQ:()=>d,ne:()=>u,nn:()=>h,th:()=>x,ud:()=>l,v:()=>c});var s=a(5155);function r(e){let{className:t="",size:a=16}=e;return(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:a,height:a,className:t,children:[(0,s.jsx)("g",{clipPath:"url(#arrow-right_a)",children:(0,s.jsx)("path",{fill:"currentColor",d:"M8.757 13.6565L14.414 7.99951L8.757 2.34351L7.343 3.75751L10.586 6.99951H2V8.99951H10.586L7.343 12.2425L8.757 13.6565Z"})}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"arrow-right_a",children:(0,s.jsx)("path",{d:"M0 0h16v16H0z"})})})]})}function l(e){let{className:t="",size:a=20}=e;return(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:a,height:a,className:t,fill:"currentColor",children:(0,s.jsx)("path",{d:"M8 5.5V12h11v-.75C14 9.5 9.5 5.5 9.5 5.5zm0 13V12h11v.75c-5 1.75-9.5 5.75-9.5 5.75z",clipRule:"evenodd",fillRule:"evenodd"})})}function i(e){let{className:t="",size:a=20}=e;return(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:a,height:a,className:t,fill:"currentColor",children:(0,s.jsx)("path",{d:"M11 5.5H7v13h4zm6 0h-4v13h4z",clipRule:"evenodd",fillRule:"evenodd"})})}function n(e){let{className:t="",size:a=20}=e;return(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:a,height:a,className:t,fill:"currentColor",children:(0,s.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})}function o(e){let{className:t="",size:a=20}=e;return(0,s.jsx)("div",{style:{width:a,height:a},className:"border-current animate-spin rounded-full border-b-2 ".concat(t)})}function c(e){let{className:t="",size:a=20}=e;return(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:a,height:a,className:t,fill:"currentColor",children:(0,s.jsx)("path",{d:"M12.5 3H12l-.299.398V3.4l-.003.003-.018.024-.088.108a10 10 0 0 1-.375.422c-.339.36-.848.855-1.52 1.381C8.348 6.392 6.37 7.553 3.82 8.017L3 8.164v7.67l.821.149c2.55.463 4.528 1.624 5.875 2.679q.812.633 1.52 1.381.241.257.464.53l.018.024.002.002.001.001.299.4h4.5V3zm.174 2.326A13 13 0 0 0 12.97 5h1.53v14h-1.53q-.145-.166-.296-.326a16 16 0 0 0-1.745-1.587C9.546 16.006 7.554 14.805 5 14.19V9.81c2.554-.615 4.546-1.815 5.929-2.898a15.6 15.6 0 0 0 1.745-1.586M19.5 6v12h2V6z",clipRule:"evenodd"})})}function d(e){let{className:t="",size:a=20}=e;return(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:a,height:a,className:t,fill:"currentColor",children:[(0,s.jsx)("path",{d:"m16.5 17.44 3.355 2.826 1.289-1.53-4.644-3.91v-.012l-2-1.674L2.145 2.736.856 4.266l4.133 3.48a12 12 0 0 1-1.168.27L3 8.166v7.669l.821.149c2.55.463 4.528 1.624 5.875 2.679q.812.633 1.52 1.381.241.257.464.53l.018.024.002.002.001.001L12 21h4.5zm-2-1.684V19h-1.53q-.145-.166-.296-.326a16 16 0 0 0-1.745-1.587C9.546 16.006 7.554 14.805 5 14.19V9.81c.63-.151 1.225-.339 1.785-.551zM16.5 4v6.902l-2-1.675V5h-1.53a14 14 0 0 1-.296.326c-.322.342-.768.78-1.335 1.255L9.777 5.273q.766-.607 1.44-1.317.24-.257.463-.53l.018-.024.002-.003h.001L12 3h4.5z",clipRule:"evenodd",fillRule:"evenodd"}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{children:(0,s.jsx)("path",{d:"M0 0h24v24H0z"})})})]})}function h(e){let{className:t="",size:a=48}=e;return(0,s.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:a,height:a,children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}function x(e){let{className:t="",size:a=20}=e;return(0,s.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:a,height:a,children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}function u(e){let{className:t="",size:a=20}=e;return(0,s.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",width:a,height:a,children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}function p(e){let{className:t=""}=e;return(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"72",height:"34",fill:"none",viewBox:"0 0 64 30",className:t,children:[(0,s.jsx)("g",{clipPath:"url(#a)",children:(0,s.jsx)("path",{fill:"#F90000",d:"M60.8 8.66c.455.455.82.82 1.184 1.229 2.368 2.594 2.641 5.87.865 8.874-.865 1.456-2.05 2.593-3.37 3.594-3.052 2.276-6.468 3.777-10.111 4.733-11.568 3.049-23.228 3.185-34.933.865-3.097-.592-6.103-1.548-8.927-3.095-1.548-.864-2.96-1.866-4.007-3.322C-.276 19.172-.458 16.67.863 14.03c.865-1.775 2.232-3.14 3.78-4.369 2.733-2.184 5.739-3.822 8.972-5.096C25.32-.213 37.39-1.124 49.732 1.288c3.37.637 6.559 1.775 9.474 3.686.592.41 1.184.82 1.73 1.32 1.093.956 1.048 1.274-.136 2.366M49.823 3.7v-.182c-.728-.136-1.412-.318-2.14-.455-9.701-1.638-19.266-1.138-28.693 1.73-4.1 1.228-8.062 2.912-11.569 5.414-1.32.956-2.641 2.003-3.689 3.231-2.414 2.867-2.14 5.78.82 8.1 1.275 1.002 2.778 1.775 4.281 2.458 3.234 1.41 6.65 2.093 10.111 2.594 8.29 1.137 16.578 1.046 24.822-.365 4.418-.773 8.699-2.047 12.616-4.368 1.594-.956 3.097-2.048 4.19-3.55 1.867-2.502 1.685-5.142-.547-7.326-.683-.683-1.457-1.274-2.277-1.82-3.826-2.503-8.061-3.55-12.57-3.459-.957 0-1.959.091-2.915.137-.592 0-1.093-.228-1.139-.865-.045-.546.365-.91.911-.955.957-.137 1.913-.364 2.87-.41 1.64-.045 3.279.046 4.918.091"})}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"a",children:(0,s.jsx)("path",{fill:"#fff",d:"M0 0h64v29.553H0z"})})})]})}a(2115)},5057:(e,t,a)=>{"use strict";a.d(t,{b:()=>n,n:()=>o});var s=a(5155),r=a(2115),l=a(968),i=a(501);let n=r.forwardRef((e,t)=>{let{className:a,disabled:r,...n}=e;return(0,s.jsx)(l.b,{ref:t,className:(0,i.cn)("text-paragraph-md font-bold font-styrene uppercase text-text-strong-950","flex items-center gap-px",a),"aria-disabled":r,...n})});function o(e){let{className:t,children:a,...r}=e;return(0,s.jsx)("span",{className:(0,i.cn)("text-primary-base","group-aria-disabled:text-text-disabled-300",t),...r,children:a||"*"})}n.displayName="LabelRoot"},8482:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ea});var s=a(5155),r=a(2115),l=a(9708),i=a(146),n=a(6694);let o="InputWrapper",c="InputEl",d="InputIcon",h="InputInlineAffixButton",x=(0,n.tv)({slots:{root:["group relative flex w-full overflow-hidden bg-bg-white-0 text-text-strong-950","transition duration-200 ease-out","divide-x divide-stroke-soft-200","before:absolute before:inset-0 before:ring-1 before:ring-inset before:ring-stroke-soft-200","before:pointer-events-none before:rounded-[inherit]","before:transition before:duration-200 before:ease-out","hover:shadow-none","has-[input:disabled]:shadow-none has-[input:disabled]:before:ring-transparent"],wrapper:["group/input-wrapper flex w-full cursor-text items-center bg-bg-white-0","transition duration-200 ease-out","has-[input:disabled]:pointer-events-none has-[input:disabled]:bg-bg-weak-50"],input:["w-full bg-transparent text-paragraph-md font-styrene text-text-strong-950 outline-none","transition duration-200 ease-out","placeholder:select-none placeholder:text-text-soft-400 placeholder:transition placeholder:duration-200 placeholder:ease-out","group-hover/input-wrapper:placeholder:text-text-sub-600","focus:outline-none","group-has-[input:focus]:placeholder:text-text-sub-600","disabled:text-text-disabled-300 disabled:placeholder:text-text-disabled-300"],icon:["flex size-5 shrink-0 select-none items-center justify-center","transition duration-200 ease-out","group-has-[:placeholder-shown]:text-text-soft-400","text-text-sub-600","group-has-[:placeholder-shown]:group-hover/input-wrapper:text-text-sub-600","group-has-[:placeholder-shown]:group-has-[input:focus]/input-wrapper:text-text-sub-600","group-has-[input:disabled]/input-wrapper:text-text-disabled-300"],affix:["shrink-0 bg-bg-white-0 text-paragraph-sm font-styrene text-text-sub-600","flex items-center justify-center truncate","transition duration-200 ease-out","group-has-[:placeholder-shown]:text-text-soft-400","group-has-[:placeholder-shown]:group-has-[input:focus]:text-text-sub-600"],inlineAffix:["text-paragraph-sm text-text-sub-600 font-styrene","group-has-[:placeholder-shown]:text-text-soft-400","group-has-[:placeholder-shown]:group-has-[input:focus]:text-text-sub-600"]},variants:{size:{medium:{root:"rounded-10",wrapper:"gap-2 px-3",input:"h-10"},small:{root:"rounded-lg",wrapper:"gap-2 px-2.5",input:"h-9"},xsmall:{root:"rounded-lg",wrapper:"gap-1.5 px-2",input:"h-8"}},hasError:{true:{root:["before:ring-error-base","hover:before:ring-error-base","has-[input:focus]:shadow-button-error-focus has-[input:focus]:before:ring-error-base"]},false:{root:["hover:before:ring-transparent"]}}},compoundVariants:[{size:"medium",class:{affix:"px-3"}},{size:["small","xsmall"],class:{affix:"px-2.5"}}],defaultVariants:{size:"medium"}});function u(e){let{className:t,children:a,size:n,hasError:u,asChild:p,...m}=e,g=r.useId(),f=p?l.DX:"div",{root:j}=x({size:n,hasError:u}),b=(0,i.B)(a,{size:n,hasError:u},[o,c,d,"InputAffixButton",h],g,p);return(0,s.jsx)(f,{className:j({class:t}),...m,children:b})}function p(e){let{className:t,children:a,size:r,hasError:i,asChild:n,...o}=e,c=n?l.DX:"label",{wrapper:d}=x({size:r,hasError:i});return(0,s.jsx)(c,{className:d({class:t}),...o,children:a})}u.displayName="InputRoot",p.displayName=o;let m=r.forwardRef((e,t)=>{let{className:a,type:r="text",size:i,hasError:n,asChild:o,...c}=e,d=o?l.DX:"input",{input:h}=x({size:i,hasError:n});return(0,s.jsx)(d,{type:r,className:h({class:a}),ref:t,...c})});function g(e){let{size:t,hasError:a,as:r,className:l,...i}=e,{icon:n}=x({size:t,hasError:a});return(0,s.jsx)(null!=r?r:"div",{className:n({class:l}),...i})}function f(e){let{className:t,children:a,size:r,hasError:l,...i}=e,{inlineAffix:n}=x({size:r,hasError:l});return(0,s.jsx)("span",{className:n({class:t}),...i,children:a})}m.displayName=c,g.displayName=d,f.displayName=h;var j=a(4346),b=a(5057),v=a(501);let y=r.forwardRef((e,t)=>{let{className:a,hasError:r,simple:l,disabled:i,...n}=e;return(0,s.jsx)("textarea",{className:(0,v.cn)(["block w-full resize-none text-paragraph-md font-styrene text-text-strong-950 outline-none",!l&&["bg-transparent bg-none min-h-[82px] pl-3 pr-2.5 pt-2.5"],l&&["shadow-regular-xs min-h-28 rounded-xl  px-3 py-2.5","ring-1 ring-inset ring-stroke-soft-200","transition duration-200 ease-out",!r&&["hover:[&:not(:focus)]:ring-transparent","focus:shadow-button-important-focus focus:ring-stroke-strong-950"],r&&["ring-error-base","focus:shadow-button-error-focus focus:ring-error-base"],i&&["ring-transparent bg-bg-weak-50"]],!i&&["placeholder:select-none placeholder:text-text-soft-400 placeholder:transition placeholder:duration-200 placeholder:ease-out","group-hover/textarea:placeholder:text-text-sub-600","focus:outline-none","focus:placeholder:text-text-sub-600"],i&&["text-text-disabled-300 placeholder:text-text-disabled-300"]],a),ref:t,disabled:i,...n})});function N(){return(0,s.jsx)("div",{className:"pointer-events-none size-3 cursor-s-resize",children:(0,s.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M9.11111 2L2 9.11111M10 6.44444L6.44444 10",className:"stroke-text-soft-400"})})})}y.displayName="Textarea",N.displayName="TextareaResizeHandle";let w=r.forwardRef((e,t)=>{let{containerClassName:a,children:r,hasError:l,simple:i,...n}=e;return i?(0,s.jsx)(y,{ref:t,simple:!0,hasError:l,...n}):(0,s.jsx)("div",{className:(0,v.cn)(["group/textarea shadow-regular-xs relative w-full rounded-xl p-1","ring-1 ring-inset ring-stroke-soft-200","transition duration-200 ease-out","has-[[disabled]]:ring-transparent has-[[disabled]]:pointer-events-none has-[[disabled]]:bg-bg-weak-50"],!l&&["hover:[&:not(:focus-within)]:ring-transparent","focus-within:shadow-button-important-focus focus-within:ring-stroke-strong-950"],l&&["ring-error-base","focus-within:shadow-button-error-focus focus-within:ring-error-base"],a),children:(0,s.jsxs)("div",{className:"grid bg-white rounded-lg",children:[(0,s.jsxs)("div",{className:"relative z-10 flex flex-col gap-2 [grid-area:1/1]",children:[(0,s.jsx)(y,{ref:t,hasError:l,...n}),(0,s.jsxs)("div",{className:"pointer-events-none flex items-center justify-end gap-1.5 pl-3 pr-2.5",children:[r,(0,s.jsx)(N,{})]})]}),(0,s.jsx)("div",{className:"min-h-full resize-y overflow-hidden opacity-0 [grid-area:1/1]"})]})})});function k(e){let{current:t,max:a,className:r}=e;return void 0===t||void 0===a?null:(0,s.jsxs)("span",{className:(0,v.cn)("text-subheading-2xs text-text-soft-400","group-has-[[disabled]]/textarea:text-text-disabled-300",{"text-error-base":t>a},r),children:[t,"/",a]})}w.displayName="TextareaRoot",k.displayName="TextareaCounter";var C=a(6981);function T(e){let{...t}=e;return(0,s.jsx)("svg",{width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t,children:(0,s.jsx)("path",{d:"M1 3.5L4 6.5L9 1.5",strokeWidth:"1.5",className:"stroke-white"})})}function D(e){let{...t}=e;return(0,s.jsx)("svg",{width:"8",height:"2",viewBox:"0 0 8 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t,children:(0,s.jsx)("path",{d:"M0 1H8",strokeWidth:"1.5",className:"stroke-static-white"})})}let I=r.forwardRef((e,t)=>{let{className:a,checked:l,...i}=e,n=r.useId();return(0,s.jsxs)(C.bL,{ref:t,checked:l,className:(0,v.cn)("group/checkbox relative flex size-5 shrink-0 items-center justify-center outline-none","focus:outline-none",a),...i,children:[(0,s.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("rect",{x:"2",y:"2",width:"16",height:"16",rx:"4",className:(0,v.cn)("fill-bg-soft-200 transition duration-200 ease-out","group-hover/checkbox:fill-bg-sub-300","group-focus/checkbox:fill-bg-strong-950","group-disabled/checkbox:fill-bg-soft-200","group-hover/checkbox:group-data-[state=checked]/checkbox:fill-bg-strong-950","group-hover/checkbox:group-data-[state=indeterminate]/checkbox:fill-bg-strong-950","group-focus/checkbox:group-data-[state=checked]/checkbox:fill-bg-strong-950","group-focus/checkbox:group-data-[state=indeterminate]/checkbox:fill-bg-strong-950","group-data-[state=checked]/checkbox:fill-bg-strong-950","group-data-[state=indeterminate]/checkbox:fill-bg-strong-950","group-disabled/checkbox:group-data-[state=checked]/checkbox:fill-bg-soft-200","group-disabled/checkbox:group-data-[state=indeterminate]/checkbox:fill-bg-soft-200")}),(0,s.jsx)("g",{filter:"url(#".concat(n,")"),children:(0,s.jsx)("rect",{x:"3.5",y:"3.5",width:"13",height:"13",rx:"2.6",className:(0,v.cn)("fill-bg-white-0 transition duration-200 ease-out","group-disabled/checkbox:hidden","group-data-[state=checked]/checkbox:opacity-0","group-data-[state=indeterminate]/checkbox:opacity-0")})}),(0,s.jsx)("defs",{children:(0,s.jsxs)("filter",{id:n,x:"1.5",y:"3.5",width:"17",height:"17",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,s.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,s.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,s.jsx)("feOffset",{dy:"2"}),(0,s.jsx)("feGaussianBlur",{stdDeviation:"1"}),(0,s.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.105882 0 0 0 0 0.109804 0 0 0 0 0.113725 0 0 0 0.12 0"}),(0,s.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_34646_2602"}),(0,s.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_34646_2602",result:"shape"})]})})]}),(0,s.jsxs)(C.C1,{forceMount:!0,className:"flex items-center justify-center",children:[(0,s.jsx)(T,{className:(0,v.cn)("absolute left-1/2 top-1/2 shrink-0 -translate-x-1/2 -translate-y-1/2 opacity-0 transition-opacity duration-200","group-data-[state=checked]/checkbox:opacity-100","group-data-[state=indeterminate]/checkbox:invisible")}),(0,s.jsx)(D,{className:(0,v.cn)("absolute left-1/2 top-1/2 shrink-0 -translate-x-1/2 -translate-y-1/2 opacity-0 transition-opacity duration-200","group-data-[state=indeterminate]/checkbox:opacity-100","group-data-[state=checked]/checkbox:invisible")})]})]})});function S(e){let{data:t,onChange:a,giftId:l}=e,[i,n]=(0,r.useState)(t);(0,r.useEffect)(()=>{n(t)},[t]),(0,r.useEffect)(()=>{0===i.number&&c()},[]);let o=(e,t)=>{let s={...i,[e]:t};if("openDate"===e&&t)try{let e=new Date(t);isNaN(e.getTime())&&console.warn("Указана некорректная дата:",t)}catch(e){console.error("Ошибка при обработке даты:",e)}n(s),a(s)};(0,r.useEffect)(()=>{i.openDate&&i.number>0&&i.englishDescription&&isNaN(new Date(i.openDate).getTime())&&o("openDate","")},[i.openDate,i.number,i.englishDescription]);let c=()=>{let e=new Date(j.l$.START_DATE);o("number",Math.ceil((new Date().getTime()-e.getTime())/864e5))};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-3 sm:col-span-2",children:[(0,s.jsx)(b.b,{htmlFor:"title",children:"Название подарка"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.title,onChange:e=>o("title",e.target.value),placeholder:"Музыкальный плеер"})})})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)(b.b,{htmlFor:"number",children:["Номер подарка ",(0,s.jsx)(b.n,{})]}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"number",id:"number",value:i.number,onChange:e=>o("number",parseInt(e.target.value)||0),required:!0,min:"1"})})})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)(b.b,{htmlFor:"openDate",children:["Дата открытия ",(0,s.jsx)(b.n,{})]}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"datetime-local",id:"openDate",value:i.openDate,onChange:e=>o("openDate",e.target.value),required:!0})})})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)(b.b,{htmlFor:"author",children:["Имя друга ",(0,s.jsx)(b.n,{})]}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.author,onChange:e=>o("author",e.target.value),placeholder:"Даша",required:!0})})})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)(b.b,{htmlFor:"nickname",children:["Никнейм друга ",(0,s.jsx)(b.n,{})]}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(f,{children:"@"}),(0,s.jsx)(m,{type:"text",value:i.nickname,onChange:e=>o("nickname",e.target.value),placeholder:"savdis",required:!0})]})})]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)(b.b,{htmlFor:"englishDescription",children:["Английское описание ",(0,s.jsx)(b.n,{})]}),(0,s.jsx)(w,{placeholder:"Each memory has a soundtrack of its own...",value:i.englishDescription,onChange:e=>o("englishDescription",e.target.value),required:!0,children:(0,s.jsx)(k,{current:i.englishDescription.length,max:200})})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-3 sm:col-span-2",children:[(0,s.jsx)(b.b,{htmlFor:"codeText",children:"Описание для кода"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{id:"codeText",value:i.codeText,onChange:e=>o("codeText",e.target.value),placeholder:"This is the part of your cipher. Collect them all to reveal the last secret"})})})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-3 sm:col-span-2",children:[(0,s.jsx)(b.b,{htmlFor:"code",children:"Секретный код"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{id:"code",value:i.code,onChange:e=>o("code",e.target.value),placeholder:"fZX+g"})})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(I,{id:"isSecret",checked:i.isSecret,onCheckedChange:e=>o("isSecret",!!e)}),(0,s.jsx)(b.b,{className:"text-paragraph-sm font-styrene uppercase text-text-strong-950",htmlFor:"isSecret",children:"Секретный подарок (скрыт от публичного просмотра)"})]})]})}I.displayName=C.bL.displayName;var z=a(7655),L=a(2918),R=a(5427);let F=(0,n.tv)({slots:{triggerRoot:["group/trigger min-w-0 shrink-0 bg-bg-white-0 shadow-regular-xs outline-none ring-1 ring-inset ring-stroke-soft-200","text-paragraph-md font-styrene text-text-strong-950","flex items-center text-left","transition duration-200 ease-out","hover:bg-bg-weak-50 hover:ring-transparent","focus:shadow-button-important-focus focus:outline-none focus:ring-stroke-strong-950","focus:text-text-strong-950 data-[placeholder]:focus:text-text-strong-950","disabled:pointer-events-none disabled:bg-bg-weak-50 disabled:text-text-disabled-300 disabled:shadow-none disabled:ring-transparent data-[placeholder]:disabled:text-text-disabled-300","data-[placeholder]:text-text-sub-600"],triggerArrow:["ml-auto size-5 shrink-0","transition duration-200 ease-out","group-data-[placeholder]/trigger:text-text-soft-400","text-text-sub-600","group-hover/trigger:text-text-sub-600 group-data-[placeholder]/trigger:group-hover:text-text-sub-600","group-focus/trigger:text-text-strong-950 group-data-[placeholder]/trigger:group-focus/trigger:text-text-strong-950","group-disabled/trigger:text-text-disabled-300 group-data-[placeholder]/trigger:group-disabled/trigger:text-text-disabled-300","group-data-[state=open]/trigger:rotate-180"],triggerIcon:["h-5 w-auto min-w-0 shrink-0 object-contain text-text-sub-600","transition duration-200 ease-out","group-data-[placeholder]/trigger:text-text-soft-400","group-hover/trigger:text-text-sub-600 group-data-[placeholder]/trigger:group-hover:text-text-sub-600","group-disabled/trigger:text-text-disabled-300 group-data-[placeholder]/trigger:group-disabled/trigger:text-text-disabled-300","group-disabled/trigger:[&:not(.remixicon)]:opacity-[.48]"],selectItemIcon:["size-5 shrink-0 bg-[length:1.25rem] text-text-sub-600","[[data-disabled]_&:not(.remixicon)]:opacity-[.48] [[data-disabled]_&]:text-text-disabled-300"]},variants:{size:{medium:{},small:{},xsmall:{}},variant:{default:{triggerRoot:"w-full"},compact:{triggerRoot:"w-auto"},compactForInput:{triggerRoot:["w-auto rounded-none shadow-none ring-0","focus:bg-bg-weak-50 focus:shadow-none focus:ring-0 focus:ring-transparent"]},inline:{triggerRoot:["h-5 min-h-5 w-auto gap-0 rounded-none bg-transparent p-0 text-text-sub-600 shadow-none ring-0","hover:bg-transparent hover:text-text-strong-950","focus:shadow-none","data-[state=open]:text-text-strong-950"],triggerIcon:["mr-1.5 text-text-soft-400","group-hover/trigger:text-text-sub-600","group-data-[state=open]/trigger:text-text-sub-600"],triggerArrow:["ml-0.5","group-hover/trigger:text-text-strong-950","group-data-[state=open]/trigger:text-text-strong-950"],selectItemIcon:"text-text-soft-400 group-hover/trigger:text-text-sub-600"}},hasError:{true:{triggerRoot:["ring-error-base","focus:shadow-button-error-focus focus:ring-error-base"]}}},compoundVariants:[{size:"medium",variant:"default",class:{triggerRoot:"h-10 min-h-10 gap-2 rounded-10 pl-3 pr-2.5"}},{size:"small",variant:"default",class:{triggerRoot:"h-9 min-h-9 gap-2 rounded-lg pl-2.5 pr-2"}},{size:"xsmall",variant:"default",class:{triggerRoot:"h-8 min-h-8 gap-1.5 rounded-lg pl-2 pr-1.5"}},{size:"medium",variant:"compact",class:{triggerRoot:"h-10 gap-1 rounded-10 pl-3 pr-2.5",triggerIcon:"-ml-0.5",selectItemIcon:"group-has-[&]/trigger:-ml-0.5"}},{size:"small",variant:"compact",class:{triggerRoot:"h-9 gap-1 rounded-lg pl-3 pr-2",triggerIcon:"-ml-0.5",selectItemIcon:"group-has-[&]/trigger:-ml-0.5"}},{size:"xsmall",variant:"compact",class:{triggerRoot:"h-8 gap-0.5 rounded-lg pl-2.5 pr-1.5",triggerIcon:"-ml-0.5 size-4",selectItemIcon:"size-4 bg-[length:1rem] group-has-[&]/trigger:-ml-0.5"}},{size:"medium",variant:"compactForInput",class:{triggerRoot:"pl-2.5 pr-2",triggerIcon:"mr-2",triggerArrow:"ml-0.5"}},{size:"small",variant:"compactForInput",class:{triggerRoot:"px-2",triggerIcon:"mr-2",triggerArrow:"ml-0.5"}},{size:"xsmall",variant:"compactForInput",class:{triggerRoot:"pl-2 pr-1.5",triggerIcon:"mr-1.5 size-4",triggerArrow:"ml-0.5",selectItemIcon:"size-4 bg-[length:1rem]"}}],defaultVariants:{variant:"default",size:"medium"}}),P=r.createContext({size:"medium",variant:"default",hasError:!1}),E=()=>r.useContext(P),U=e=>{let{size:t="medium",variant:a="default",hasError:r,...l}=e;return(0,s.jsx)(P.Provider,{value:{size:t,variant:a,hasError:r},children:(0,s.jsx)(L.bL,{...l})})};U.displayName="SelectRoot",L.YJ.displayName="SelectGroup";let M=L.WT;M.displayName="SelectValue",L.wv.displayName="SelectSeparator",L.JU.displayName="SelectGroupLabel";let V=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e,{size:n,variant:o,hasError:c}=E(),{triggerRoot:d,triggerArrow:h}=F({size:n,variant:o,hasError:c});return(0,s.jsxs)(L.l9,{ref:t,className:d({class:a}),...i,children:[(0,s.jsx)(l.xV,{children:r}),(0,s.jsx)(L.In,{asChild:!0,children:(0,s.jsx)(R.eQr,{className:h()})})]})});V.displayName="SelectTrigger";let O=r.forwardRef((e,t)=>{let{className:a,position:r="popper",children:l,sideOffset:i=8,collisionPadding:n=8,...o}=e;return(0,s.jsx)(L.ZL,{children:(0,s.jsx)(L.UC,{ref:t,className:(0,v.cn)("relative z-50 overflow-hidden rounded-2xl bg-bg-white-0 shadow-regular-md ring-1 ring-inset ring-stroke-soft-200","min-w-[--radix-select-trigger-width] max-w-[max(var(--radix-select-trigger-width),320px)]","max-h-[--radix-select-content-available-height]","data-[state=open]:animate-in data-[state=open]:fade-in-0","data-[state=closed]:animate-out data-[state=closed]:fade-out-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[side=bottom]:slide-in-from-top-2 data-[side=top]:slide-in-from-bottom-2",a),sideOffset:i,position:r,collisionPadding:n,...o,children:(0,s.jsxs)(z.bL,{type:"auto",children:[(0,s.jsx)(L.LM,{asChild:!0,children:(0,s.jsx)(z.LM,{style:{overflowY:void 0},className:"max-h-[196px] w-full scroll-py-2 overflow-auto p-2",children:l})}),(0,s.jsx)(z.Ze,{orientation:"vertical",children:(0,s.jsx)(z.zi,{className:"!w-1 rounded bg-bg-soft-200"})})]})})})});O.displayName="SelectContent";let A=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e,{size:i}=E();return(0,s.jsxs)(L.q7,{ref:t,className:(0,v.cn)("group relative cursor-pointer select-none rounded-lg p-2 pr-9 text-paragraph-md font-styrene text-text-strong-950","flex items-center gap-2 transition duration-200 ease-out","data-[disabled]:pointer-events-none data-[disabled]:text-text-disabled-300","data-[highlighted]:bg-bg-weak-50 data-[highlighted]:outline-0",{"gap-1.5 pr-[34px]":"xsmall"===i},a),...l,children:[(0,s.jsx)(L.p4,{asChild:!0,children:(0,s.jsx)("span",{className:(0,v.cn)("flex flex-1 items-center gap-2","group-disabled:text-text-disabled-300",{"gap-1.5":"xsmall"===i}),children:"string"==typeof r?(0,s.jsx)("span",{className:"line-clamp-1",children:r}):r})}),(0,s.jsx)(L.VF,{asChild:!0,children:(0,s.jsx)(R.s0,{className:"absolute right-2 top-1/2 size-5 shrink-0 -translate-y-1/2 text-text-sub-600"})})]})});function H(e){let{block:t,onChange:a,giftId:l}=e,[i,n]=(0,r.useState)(t),[o,c]=(0,r.useState)(!1),[d,h]=(0,r.useState)([]);(0,r.useEffect)(()=>{n(t)},[t]);let x=e=>{let t={...i,...e};n(t),a(t)},f=async(e,t)=>{if(!l)return void alert("Сначала сохраните подарок с основными данными, затем вы сможете загружать файлы");c(!0);try{let a=new FormData;a.append("file",e),a.append("giftId",l),a.append("fileType","block");let s=await fetch("/api/upload",{method:"POST",body:a});if(s.ok){let{url:e}=await s.json();x({[t]:e})}else alert("Ошибка загрузки файла")}catch(e){console.error("Ошибка загрузки:",e),alert("Ошибка загрузки файла")}finally{c(!1)}};switch(t.type){case"text":return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(b.b,{className:"mb-2 block text-paragraph-sm",children:["Текст ",(0,s.jsx)(b.n,{})]}),(0,s.jsx)(w,{value:i.content||"",onChange:e=>x({content:e.target.value}),placeholder:"Введите текст..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Стиль"}),(0,s.jsxs)(U,{value:i.style||"normal",onValueChange:e=>x({style:e}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите стиль"})}),(0,s.jsx)(O,{children:[{label:"Обычный текст",value:"normal"},{label:"Заголовок",value:"title"},{label:"Подзаголовок",value:"subtitle"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]})]});case"quote":return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(b.b,{className:"mb-2 block text-paragraph-sm",children:["Текст цитаты ",(0,s.jsx)(b.n,{})]}),(0,s.jsx)(w,{value:i.content||"",onChange:e=>x({content:e.target.value}),placeholder:"Введите цитату..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Стиль цитаты"}),(0,s.jsxs)(U,{value:i.style||"small",onValueChange:e=>x({style:e}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите стиль"})}),(0,s.jsx)(O,{children:[{label:"Малый",value:"small"},{label:"Большой",value:"big"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]})]});case"image":return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Заголовок"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.title||"",onChange:e=>x({title:e.target.value}),placeholder:"Заголовок блока"})})})]}),(0,s.jsxs)("div",{className:"pt-2",children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Текст"}),(0,s.jsx)(w,{value:i.text||"",onChange:e=>x({text:e.target.value}),placeholder:"Описание к изображению"})]}),(0,s.jsx)("div",{className:"pt-2",children:(0,s.jsxs)("div",{className:"space-y-2",children:[i.url&&(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("img",{src:i.url,alt:"Превью",className:"h-40 rounded-lg border border-gray-300 object-cover"})}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&f(a,"url")},className:"block w-full font-styrene text-paragraph-sm font-medium uppercase text-gray-500 file:mr-4 file:rounded-md file:border-0 file:px-4 file:py-2 file:font-styrene file:text-paragraph-sm file:font-medium file:uppercase",disabled:o}),o&&(0,s.jsx)("div",{className:"text-blue-500 mt-1 text-xs",children:"Загрузка изображения..."}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{type:"url",value:i.url||"",onChange:e=>x({url:e.target.value}),placeholder:"Или введите URL изображения..."}),i.url&&(0,s.jsx)("button",{type:"button",onClick:()=>x({url:""}),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})})]})}),(0,s.jsxs)("div",{className:"pt-2",children:[(0,s.jsx)(b.b,{className:"mb-3 block text-paragraph-sm",children:"Подпись под фото"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.caption||"",onChange:e=>x({caption:e.target.value}),placeholder:"Подпись под изображением"})})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 pt-2 sm:grid-cols-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Расположение"}),(0,s.jsxs)(U,{value:i.layout||"image-center",onValueChange:e=>x({layout:e}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите стиль"})}),(0,s.jsx)(O,{children:[{label:"По центру",value:"image-center"},{label:"Слева",value:"image-left"},{label:"Справа",value:"image-right"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Размер"}),(0,s.jsxs)(U,{value:i.size||"medium",onValueChange:e=>x({size:e}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите стиль"})}),(0,s.jsx)(O,{children:[{label:"Маленький",value:"small"},{label:"Средний",value:"medium"},{label:"Большой",value:"large"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Ориентация"}),(0,s.jsxs)(U,{value:i.orientation||"horizontal",onValueChange:e=>x({orientation:e}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите стиль"})}),(0,s.jsx)(O,{children:[{label:"Горизонтальная",value:"horizontal"},{label:"Вертикальная",value:"vertical"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]})]})]});case"music":return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-3 block text-paragraph-sm",children:"Заголовок"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.title||"",onChange:e=>x({title:e.target.value}),placeholder:"Заголовок блока"})})})]}),(0,s.jsxs)("div",{className:"pt-2",children:[(0,s.jsxs)(b.b,{className:"mb-3 block text-paragraph-sm",children:["Аудио файл ",(0,s.jsx)(b.n,{})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("input",{type:"file",accept:"audio/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&f(a,"url")},className:"block w-full font-styrene text-paragraph-sm font-medium uppercase text-gray-500 file:mr-4 file:rounded-md file:border-0 file:px-4 file:py-2 file:font-styrene file:text-paragraph-sm file:font-medium file:uppercase",disabled:o}),o&&(0,s.jsx)("div",{className:"text-blue-500 mt-1 text-xs",children:"Загрузка аудио..."}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{type:"url",value:i.url||"",onChange:e=>x({url:e.target.value}),placeholder:"Или введите URL аудио файла"}),i.url&&(0,s.jsx)("button",{type:"button",onClick:()=>x({url:""}),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})})]})]}),(0,s.jsxs)("div",{className:"pt-2",children:[(0,s.jsxs)(b.b,{className:"mb-3 block text-paragraph-sm",children:["Обложка ",(0,s.jsx)(b.n,{})]}),i.coverUrl&&(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("img",{src:i.coverUrl,alt:"Обложка",className:"h-20 w-20 rounded-lg border border-gray-300 object-cover"})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&f(a,"coverUrl")},className:"block w-full font-styrene text-paragraph-sm font-medium uppercase text-gray-500 file:mr-4 file:rounded-md file:border-0 file:px-4 file:py-2 file:font-styrene file:text-paragraph-sm file:font-medium file:uppercase",disabled:o}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{type:"url",value:i.coverUrl||"",onChange:e=>x({coverUrl:e.target.value}),placeholder:"URL обложки"}),i.coverUrl&&(0,s.jsx)("button",{type:"button",onClick:()=>x({coverUrl:""}),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 pt-2 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-3 block text-paragraph-sm",children:"Исполнитель"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.artist||"",onChange:e=>x({artist:e.target.value}),placeholder:"Имя исполнителя"})})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-3 block text-paragraph-sm",children:"Название трека"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.trackName||"",onChange:e=>x({trackName:e.target.value}),placeholder:"Название песни"})})})]})]})]});case"two-images":return(()=>{var e,t,a,r,n,o,c,f,j,v,y,N,k,C;let T=i.images||[{url:"",title:"",text:"",caption:"",layout:"text-top"},{url:"",title:"",text:"",caption:"",layout:"text-top"}],D=e=>{x({images:e})},I=(e,t,a)=>{let s=[...T];s[e]={...s[e],[t]:a},D(s)},S=async(e,t)=>{if(!l)return void alert("Сначала сохраните подарок с основными данными, затем вы сможете загружать файлы");h(e=>[...e,t]);try{let a=new FormData;a.append("file",e),a.append("giftId",l),a.append("fileType","block");let s=await fetch("/api/upload",{method:"POST",body:a});if(s.ok){let{url:e}=await s.json();I(t,"url",e)}else alert("Ошибка загрузки файла")}catch(e){console.error("Ошибка загрузки:",e),alert("Ошибка загрузки файла")}finally{h(e=>e.filter(e=>e!==t))}};return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Размер"}),(0,s.jsxs)(U,{value:i.size||"medium",onValueChange:e=>x({size:e}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите размер"})}),(0,s.jsx)(O,{children:[{label:"Маленький",value:"small"},{label:"Средний",value:"medium"},{label:"Большой",value:"large"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Ориентация"}),(0,s.jsxs)(U,{value:i.orientation||"horizontal",onValueChange:e=>x({orientation:e}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите ориентацию"})}),(0,s.jsx)(O,{children:[{label:"Горизонтальная",value:"horizontal"},{label:"Вертикальная",value:"vertical"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]})]}),(0,s.jsxs)("div",{className:"rounded-md border border-gray-200 p-4",children:[(0,s.jsx)("h3",{className:"mb-4 font-styrene text-lg font-medium",children:"Изображение 1"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(null==(e=T[0])?void 0:e.url)&&(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("img",{src:T[0].url,alt:"Превью",className:"h-40 rounded-lg border border-gray-300 object-cover"})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&S(a,0)},className:"block w-full font-styrene text-paragraph-sm font-medium uppercase text-gray-500 file:mr-4 file:rounded-md file:border-0 file:px-4 file:py-2 file:font-styrene file:text-paragraph-sm file:font-medium file:uppercase",disabled:d.includes(0)}),d.includes(0)&&(0,s.jsx)("div",{className:"text-blue-500 mt-1 text-xs",children:"Загрузка изображения..."}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{type:"url",value:(null==(t=T[0])?void 0:t.url)||"",onChange:e=>I(0,"url",e.target.value),placeholder:"Или введите URL изображения..."}),(null==(a=T[0])?void 0:a.url)&&(0,s.jsx)("button",{type:"button",onClick:()=>I(0,"url",""),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Заголовок"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:(null==(r=T[0])?void 0:r.title)||"",onChange:e=>I(0,"title",e.target.value),placeholder:"Заголовок изображения"})})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Текст"}),(0,s.jsx)(w,{value:(null==(n=T[0])?void 0:n.text)||"",onChange:e=>I(0,"text",e.target.value),placeholder:"Описание изображения"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Подпись"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:(null==(o=T[0])?void 0:o.caption)||"",onChange:e=>I(0,"caption",e.target.value),placeholder:"Подпись под изображением"})})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Расположение текста"}),(0,s.jsxs)(U,{value:(null==(c=T[0])?void 0:c.layout)||"text-top",onValueChange:e=>I(0,"layout",e),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите расположение"})}),(0,s.jsx)(O,{children:[{label:"Текст сверху",value:"text-top"},{label:"Текст снизу",value:"text-bottom"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]})]})]}),(0,s.jsxs)("div",{className:"rounded-md border border-gray-200 p-4",children:[(0,s.jsx)("h3",{className:"mb-4 font-styrene text-lg font-medium",children:"Изображение 2"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(null==(f=T[1])?void 0:f.url)&&(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("img",{src:T[1].url,alt:"Превью",className:"h-40 rounded-lg border border-gray-300 object-cover"})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&S(a,1)},className:"block w-full font-styrene text-paragraph-sm font-medium uppercase text-gray-500 file:mr-4 file:rounded-md file:border-0 file:px-4 file:py-2 file:font-styrene file:text-paragraph-sm file:font-medium file:uppercase",disabled:d.includes(1)}),d.includes(1)&&(0,s.jsx)("div",{className:"text-blue-500 mt-1 text-xs",children:"Загрузка изображения..."}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{type:"url",value:(null==(j=T[1])?void 0:j.url)||"",onChange:e=>I(1,"url",e.target.value),placeholder:"Или введите URL изображения..."}),(null==(v=T[1])?void 0:v.url)&&(0,s.jsx)("button",{type:"button",onClick:()=>I(1,"url",""),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Заголовок"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:(null==(y=T[1])?void 0:y.title)||"",onChange:e=>I(1,"title",e.target.value),placeholder:"Заголовок изображения"})})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Текст"}),(0,s.jsx)(w,{value:(null==(N=T[1])?void 0:N.text)||"",onChange:e=>I(1,"text",e.target.value),placeholder:"Описание изображения"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Подпись"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:(null==(k=T[1])?void 0:k.caption)||"",onChange:e=>I(1,"caption",e.target.value),placeholder:"Подпись под изображением"})})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Расположение текста"}),(0,s.jsxs)(U,{value:(null==(C=T[1])?void 0:C.layout)||"text-top",onValueChange:e=>I(1,"layout",e),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите расположение"})}),(0,s.jsx)(O,{children:[{label:"Текст сверху",value:"text-top"},{label:"Текст снизу",value:"text-bottom"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]})]})]})]})})();case"gallery":return(()=>{let e=i.images||[{url:"",caption:""}],t=e=>{x({images:e})},a=(a,s,r)=>{let l=[...e];l[a]={...l[a],[s]:r},t(l)},r=async(e,t)=>{if(!l)return void alert("Сначала сохраните подарок с основными данными, затем вы сможете загружать файлы");h(e=>[...e,t]);try{let s=new FormData;s.append("file",e),s.append("giftId",l),s.append("fileType","block");let r=await fetch("/api/upload",{method:"POST",body:s});if(r.ok){let{url:e}=await r.json();a(t,"url",e)}else alert("Ошибка загрузки файла")}catch(e){console.error("Ошибка загрузки:",e),alert("Ошибка загрузки файла")}finally{h(e=>e.filter(e=>e!==t))}},n=a=>{t(e.filter((e,t)=>t!==a))};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Заголовок галереи"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.title||"",onChange:e=>x({title:e.target.value}),placeholder:"Заголовок галереи"})})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Текст галереи"}),(0,s.jsx)(w,{value:i.text||"",onChange:e=>x({text:e.target.value}),placeholder:"Описание галереи"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Размер текста"}),(0,s.jsxs)(U,{value:i.textSize||"small",onValueChange:e=>x({textSize:e}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите размер текста"})}),(0,s.jsx)(O,{children:[{label:"Маленький",value:"small"},{label:"Большой",value:"medium"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Количество колонок"}),(0,s.jsxs)(U,{value:String(i.columns||2),onValueChange:e=>x({columns:Number(e)}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите количество колонок"})}),(0,s.jsx)(O,{children:[{label:"2 колонки",value:"2"},{label:"3 колонки",value:"3"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]}),(0,s.jsxs)("div",{className:"rounded-md border border-gray-200 bg-white p-4",children:[(0,s.jsx)("div",{className:"mb-4 flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)(b.b,{className:"block text-paragraph-sm",children:["Изображения галереи ",(0,s.jsx)(b.n,{})]}),(0,s.jsxs)("div",{className:"mt-1 text-xs text-gray-500",children:[e.length," из 6 изображений"]})]})}),e.map((t,l)=>(0,s.jsxs)("div",{className:"mb-6 rounded-md border border-gray-200 bg-white p-4",children:[(0,s.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,s.jsxs)("h3",{className:"font-styrene text-paragraph-sm font-medium uppercase",children:["Изображение ",l+1]}),e.length>1&&(0,s.jsx)("button",{type:"button",onClick:()=>n(l),className:"rounded-md border border-red-300 bg-red-50 px-2 py-1 text-xs font-medium text-red-600",children:"Удалить"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[t.url&&(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("img",{src:t.url,alt:"Превью ".concat(l+1),className:"h-40 rounded-lg border border-gray-300 object-cover"})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&r(a,l)},className:"block w-full font-styrene text-paragraph-sm font-medium uppercase text-gray-500 file:mr-4 file:rounded-md file:border-0 file:px-4 file:py-2 file:font-styrene file:text-paragraph-sm file:font-medium file:uppercase",disabled:d.includes(l)}),d.includes(l)&&(0,s.jsx)("div",{className:"text-blue-500 mt-1 text-xs",children:"Загрузка изображения..."}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{type:"url",value:t.url||"",onChange:e=>a(l,"url",e.target.value),placeholder:"Или введите URL изображения..."}),t.url&&(0,s.jsx)("button",{type:"button",onClick:()=>a(l,"url",""),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Подпись"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:t.caption||"",onChange:e=>a(l,"caption",e.target.value),placeholder:"Подпись под изображением"})})})]})]})]},l)),(0,s.jsx)("div",{className:"mt-4 flex justify-center",children:(0,s.jsx)("button",{type:"button",onClick:()=>{e.length<6&&t([...e,{url:"",caption:""}])},className:"rounded-md px-4 py-2 text-sm font-medium ".concat(e.length>=6?"cursor-not-allowed bg-neutral-200 text-gray-500":"hover:bg-primary-600 bg-bg-strong-950 text-white"),disabled:e.length>=6,children:e.length>=6?"Достигнут лимит изображений (6)":"Добавить еще изображение"})})]})]})})();case"video-circle":return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Заголовок"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.title||"",onChange:e=>x({title:e.target.value}),placeholder:"Заголовок блока"})})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Текст"}),(0,s.jsx)(w,{value:i.text||"",onChange:e=>x({text:e.target.value}),placeholder:"Описание к видео"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Размер текста"}),(0,s.jsxs)(U,{value:i.textSize||"small",onValueChange:e=>x({textSize:e}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите размер текста"})}),(0,s.jsx)(O,{children:[{label:"Маленький",value:"small"},{label:"Большой",value:"medium"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]}),(0,s.jsx)("div",{className:"pt-0",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("input",{type:"file",accept:"video/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&f(a,"url")},className:"block w-full font-styrene text-paragraph-sm font-medium uppercase text-gray-500 file:mr-4 file:rounded-md file:border-0 file:px-4 file:py-2 file:font-styrene file:text-paragraph-sm file:font-medium file:uppercase",disabled:o}),o&&(0,s.jsx)("div",{className:"text-blue-500 mt-1 text-xs",children:"Загрузка видео..."}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{type:"url",value:i.url||"",onChange:e=>x({url:e.target.value}),placeholder:"Или введите URL видео..."}),i.url&&(0,s.jsx)("button",{type:"button",onClick:()=>x({url:""}),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})})]})}),(0,s.jsxs)("div",{className:"pt-2",children:[(0,s.jsx)(b.b,{className:"mb-3 block text-paragraph-sm",children:"Подпись под видео"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.caption||"",onChange:e=>x({caption:e.target.value}),placeholder:"Подпись под видео"})})})]}),(0,s.jsxs)("div",{className:"pt-2",children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Размер видеокружка"}),(0,s.jsxs)(U,{value:i.size||"medium",onValueChange:e=>x({size:e}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите размер"})}),(0,s.jsx)(O,{children:[{label:"Маленький",value:"small"},{label:"Средний",value:"medium"},{label:"Большой",value:"large"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(I,{id:"autoplay",checked:i.autoplay||!1,onCheckedChange:e=>x({autoplay:e})}),(0,s.jsx)(b.b,{className:"font-styrene text-paragraph-sm font-medium text-text-strong-950",htmlFor:"autoplay",children:"Автовоспроизведение"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(I,{id:"muted",checked:!1!==i.muted,onCheckedChange:e=>x({muted:e})}),(0,s.jsx)(b.b,{className:"font-styrene text-paragraph-sm font-medium text-text-strong-950",htmlFor:"muted",children:"Без звука"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(I,{id:"loop",checked:!1!==i.loop,onCheckedChange:e=>x({loop:e})}),(0,s.jsx)(b.b,{className:"font-styrene text-paragraph-sm font-medium text-text-strong-950",htmlFor:"loop",children:"Зацикленное воспроизведение"})]})]})]});case"video":return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Заголовок"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.title||"",onChange:e=>x({title:e.target.value}),placeholder:"Заголовок блока"})})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Текст"}),(0,s.jsx)(w,{value:i.text||"",onChange:e=>x({text:e.target.value}),placeholder:"Описание к видео"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Размер текста"}),(0,s.jsxs)(U,{value:i.textSize||"small",onValueChange:e=>x({textSize:e}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите размер текста"})}),(0,s.jsx)(O,{children:[{label:"Маленький",value:"small"},{label:"Большой",value:"medium"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]}),(0,s.jsx)("div",{className:"pt-0",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("input",{type:"file",accept:"video/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&f(a,"url")},className:"block w-full font-styrene text-paragraph-sm font-medium uppercase text-gray-500 file:mr-4 file:rounded-md file:border-0 file:px-4 file:py-2 file:font-styrene file:text-paragraph-sm file:font-medium file:uppercase",disabled:o}),o&&(0,s.jsx)("div",{className:"text-blue-500 mt-1 text-xs",children:"Загрузка видео..."}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{type:"url",value:i.url||"",onChange:e=>x({url:e.target.value}),placeholder:"Или введите URL видео..."}),i.url&&(0,s.jsx)("button",{type:"button",onClick:()=>x({url:""}),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})})]})}),(0,s.jsxs)("div",{className:"pt-2",children:[(0,s.jsx)(b.b,{className:"mb-3 block text-paragraph-sm",children:"Подпись под видео"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.caption||"",onChange:e=>x({caption:e.target.value}),placeholder:"Подпись под видео"})})})]}),(0,s.jsxs)("div",{className:"pt-2",children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Размер видео"}),(0,s.jsxs)(U,{value:i.size||"medium",onValueChange:e=>x({size:e}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите размер"})}),(0,s.jsx)(O,{children:[{label:"Маленький (1/2 ширины)",value:"small"},{label:"Средний (2/3 ширины)",value:"medium"},{label:"Большой (полная ширина)",value:"large"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(I,{id:"video-autoplay",checked:i.autoplay||!1,onCheckedChange:e=>x({autoplay:e})}),(0,s.jsx)(b.b,{className:"font-styrene text-paragraph-sm font-medium text-text-strong-950",htmlFor:"video-autoplay",children:"Автовоспроизведение"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(I,{id:"video-muted",checked:!1!==i.muted,onCheckedChange:e=>x({muted:e})}),(0,s.jsx)(b.b,{className:"font-styrene text-paragraph-sm font-medium text-text-strong-950",htmlFor:"video-muted",children:"Без звука"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(I,{id:"video-loop",checked:i.loop||!1,onCheckedChange:e=>x({loop:e})}),(0,s.jsx)(b.b,{className:"font-styrene text-paragraph-sm font-medium text-text-strong-950",htmlFor:"video-loop",children:"Зацикленное воспроизведение"})]})]})]});case"audio-message":return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Заголовок"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.title||"",onChange:e=>x({title:e.target.value}),placeholder:"Заголовок блока"})})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Текст"}),(0,s.jsx)(w,{value:i.text||"",onChange:e=>x({text:e.target.value}),placeholder:"Описание к голосовому сообщению"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-2 block text-paragraph-sm",children:"Размер текста"}),(0,s.jsxs)(U,{value:i.textSize||"small",onValueChange:e=>x({textSize:e}),children:[(0,s.jsx)(V,{children:(0,s.jsx)(M,{placeholder:"Выберите размер текста"})}),(0,s.jsx)(O,{children:[{label:"Маленький",value:"small"},{label:"Большой",value:"medium"}].map(e=>{let{label:t,value:a}=e;return(0,s.jsx)(A,{value:a,children:t},a)})})]})]}),(0,s.jsx)("div",{className:"pt-0",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("input",{type:"file",accept:"audio/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&f(a,"url")},className:"block w-full font-styrene text-paragraph-sm font-medium uppercase text-gray-500 file:mr-4 file:rounded-md file:border-0 file:px-4 file:py-2 file:font-styrene file:text-paragraph-sm file:font-medium file:uppercase",disabled:o}),o&&(0,s.jsx)("div",{className:"text-blue-500 mt-1 text-xs",children:"Загрузка аудио..."}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{type:"url",value:i.url||"",onChange:e=>x({url:e.target.value}),placeholder:"Или введите URL аудио файла..."}),i.url&&(0,s.jsx)("button",{type:"button",onClick:()=>x({url:""}),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})})]})})]});default:return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"rounded-md border p-4",children:(0,s.jsxs)("p",{className:"font-styrene text-paragraph-sm",children:['\uD83D\uDEA7 Редактор для блока типа "',t.type,'" в разработке. Пока что можно редактировать только базовые поля.']})}),"url"in t&&(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-3 block text-paragraph-sm",children:"URL файла"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"url",value:i.url||"",onChange:e=>x({url:e.target.value}),placeholder:"URL медиа файла"})})})]}),"title"in t&&(0,s.jsxs)("div",{children:[(0,s.jsx)(b.b,{className:"mb-3 block text-paragraph-sm",children:"Заголовок"}),(0,s.jsx)(u,{children:(0,s.jsx)(p,{children:(0,s.jsx)(m,{type:"text",value:i.title||"",onChange:e=>x({title:e.target.value}),placeholder:"Заголовок блока"})})})]})]})}}A.displayName="SelectItem";var B=a(4629);function _(e){var t,a,l;let{content:i,onChange:n,giftId:o}=e,[c,d]=(0,r.useState)(i),[h,x]=(0,r.useState)(null),[u,p]=(0,r.useState)([]);(0,r.useEffect)(()=>{d(i)},[i]);let m=e=>{d(e),n(e)},g=(e,t)=>{m({...c,metadata:{...c.metadata,[e]:t}})},f=(e,t)=>{let a=[...c.blocks];a[e]=t,m({...c,blocks:a})},j=e=>{let t;switch(e){case"text":t={type:"text",content:"",style:"normal"};break;case"quote":t={type:"quote",content:"",style:"small"};break;case"image":t={type:"image",url:"",layout:"image-center",size:"medium",orientation:"horizontal"};break;case"two-images":t={type:"two-images",images:[{url:""},{url:""}],size:"medium",orientation:"horizontal"};break;case"gallery":t={type:"gallery",images:[{url:""}],columns:2};break;case"video-circle":t={type:"video-circle",url:"",size:"medium",autoplay:!1,muted:!0,loop:!1};break;case"video":t={type:"video",url:"",size:"medium",autoplay:!1,muted:!0,loop:!1};break;case"audio-message":t={type:"audio-message",url:""};break;case"music":t={type:"music",url:"",coverUrl:"",artist:"",trackName:""};break;default:return}m({...c,blocks:[...c.blocks,t]})},v=e=>{let t=c.blocks.filter((t,a)=>a!==e);m({...c,blocks:t}),p(t=>t.filter(t=>t!==e))},y=(e,t)=>{let a=[...c.blocks],s=a[e];s&&(a.splice(e,1),a.splice(t,0,s),m({...c,blocks:a}),p(a=>{let s=[...a];return s.includes(e)&&(s.splice(s.indexOf(e),1),s.push(t)),s}))},N=e=>{x(e)},C=e=>{e.preventDefault()},T=(e,t)=>{e.preventDefault(),null!==h&&h!==t&&y(h,t),x(null)},D=e=>{p(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},I=[{type:"text",name:"Текст",icon:(0,s.jsx)(R.NtT,{})},{type:"quote",name:"Цитата",icon:(0,s.jsx)(R.Ead,{})},{type:"image",name:"Фото",icon:(0,s.jsx)(R.fsL,{})},{type:"two-images",name:"Два фото",icon:(0,s.jsx)(R.Ylc,{})},{type:"gallery",name:"Галерея",icon:(0,s.jsx)(R.ugJ,{})},{type:"video-circle",name:"Видеокружок",icon:(0,s.jsx)(R.CFw,{})},{type:"video",name:"Видео",icon:(0,s.jsx)(R.xi0,{})},{type:"audio-message",name:"Голосовое",icon:(0,s.jsx)(R.RQr,{})},{type:"music",name:"Музыка",icon:(0,s.jsx)(R.bDH,{})}];return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsx)(b.b,{htmlFor:"description",children:"Базовое сообщение"}),(0,s.jsx)(w,{placeholder:"Основной текст поздравления",value:(null==(t=c.metadata)?void 0:t.description)||"",onChange:e=>g("description",e.target.value),children:(0,s.jsx)(k,{current:(null==(l=c.metadata)||null==(a=l.description)?void 0:a.length)||0,max:200})})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsx)(b.b,{htmlFor:"description",children:"Добавить блок контента"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3",children:I.map(e=>(0,s.jsxs)("button",{onClick:()=>j(e.type),className:"flex items-center rounded-lg border border-gray-200 p-2 text-left transition-colors",children:[(0,s.jsx)("span",{className:"mr-3 mt-1",children:e.icon}),(0,s.jsx)("h4",{className:"font-styrene text-paragraph-sm font-medium uppercase text-adaptive",children:e.name})]},e.type))})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)(b.b,{htmlFor:"description",children:["Блоки контента (",c.blocks.length,")"]})}),0===c.blocks.length?(0,s.jsxs)("div",{className:"rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 py-12 text-center",children:[(0,s.jsx)(B.nn,{className:"mx-auto text-neutral-300"}),(0,s.jsx)("h3",{className:"mt-2 text-paragraph-md font-styrene uppercase text-adaptive font-medium",children:"Нет блоков контента"})]}):(0,s.jsx)("div",{className:"space-y-4",children:c.blocks.map((e,t)=>{var a;return(0,s.jsxs)("div",{draggable:!0,onDragStart:()=>N(t),onDragOver:C,onDrop:e=>T(e,t),className:"rounded-lg border bg-white ".concat(h===t?"border-indigo-300 bg-indigo-50":"border-gray-200"," transition-all duration-200"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between border-b border-gray-200 p-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"cursor-move",children:(0,s.jsx)(B.th,{size:20,className:"text-neutral-300 hover:text-neutral-600 transition-colors"})}),(0,s.jsxs)("span",{className:"text-paragraph-sm uppercase font-styrene font-medium text-text-strong-950",children:["Блок #",t+1,":"," ",(null==(a=I.find(t=>t.type===e.type))?void 0:a.name)||"Неизвестный тип"]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{onClick:()=>D(t),className:"p-1 text-neutral-400 hover:text-neutral-600 transition-colors",title:u.includes(t)?"Развернуть блок":"Свернуть блок",children:u.includes(t)?(0,s.jsx)(R.eQr,{size:24}):(0,s.jsx)(R.F$e,{size:24})}),(0,s.jsx)("button",{onClick:()=>v(t),className:"p-1 text-neutral-400 hover:text-neutral-600 transition-colors",title:"Удалить блок",children:(0,s.jsx)(B.ne,{size:20})})]})]}),!u.includes(t)&&(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(H,{block:e,onChange:e=>f(t,e),giftId:o})})]},t)})})]})]})}let q="AlertIcon",Q=(0,n.tv)({slots:{root:"w-full",wrapper:["grid w-full auto-cols-auto grid-flow-col grid-cols-1 items-start has-[>svg:first-child]:grid-cols-[auto,minmax(0,1fr)]","transition duration-200 ease-out group-data-[expanded=false]/toast:group-data-[front=false]/toast:opacity-0"],icon:"shrink-0",closeIcon:""},variants:{variant:{filled:{root:"text-white",closeIcon:"text-static-white opacity-[.72]"},light:{root:"text-text-strong-950",closeIcon:"text-text-strong-950 opacity-40"},lighter:{root:"text-text-strong-950",closeIcon:"text-text-strong-950 opacity-40"},stroke:{root:"bg-bg-white-0 text-text-strong-950 shadow-regular-md ring-1 ring-inset ring-stroke-soft-200",closeIcon:"text-text-strong-950 opacity-40"}},status:{error:{},warning:{},success:{},information:{},feature:{}},size:{xsmall:{root:"rounded-lg p-2 text-paragraph-xs font-styrene uppercase",wrapper:"gap-2 items-center",icon:"size-4",closeIcon:"size-4"},small:{root:"rounded-lg px-2.5 py-2 text-paragraph-sm font-styrene uppercase",wrapper:"gap-2 items-center",icon:"size-5",closeIcon:"size-5"},large:{root:"rounded-xl p-3.5 pb-4 text-paragraph-sm font-styrene uppercase",wrapper:"items-start gap-3",icon:"size-5",closeIcon:"size-5"}}},compoundVariants:[{variant:"filled",status:"error",class:{root:"bg-error-base"}},{variant:"filled",status:"warning",class:{root:"bg-warning-base"}},{variant:"filled",status:"success",class:{root:"bg-success-base"}},{variant:"filled",status:"information",class:{root:"bg-information-base"}},{variant:"filled",status:"feature",class:{root:"bg-faded-base"}},{variant:"light",status:"error",class:{root:"bg-error-light"}},{variant:"light",status:"warning",class:{root:"bg-warning-light"}},{variant:"light",status:"success",class:{root:"bg-success-light"}},{variant:"light",status:"information",class:{root:"bg-information-light"}},{variant:"light",status:"feature",class:{root:"bg-faded-light"}},{variant:"lighter",status:"error",class:{root:"bg-error-lighter"}},{variant:"lighter",status:"warning",class:{root:"bg-warning-lighter"}},{variant:"lighter",status:"success",class:{root:"bg-success-lighter"}},{variant:"lighter",status:"information",class:{root:"bg-information-lighter"}},{variant:"lighter",status:"feature",class:{root:"bg-faded-lighter"}},{variant:["light","lighter","stroke"],status:"error",class:{icon:"text-error-base"}},{variant:["light","lighter","stroke"],status:"warning",class:{icon:"text-warning-base"}},{variant:["light","lighter","stroke"],status:"success",class:{icon:"text-success-base"}},{variant:["light","lighter","stroke"],status:"information",class:{icon:"text-information-base"}},{variant:["light","lighter","stroke"],status:"feature",class:{icon:"text-faded-base"}}],defaultVariants:{size:"small",variant:"filled",status:"information"}}),G=r.forwardRef((e,t)=>{let{children:a,className:l,wrapperClassName:n,size:o,variant:c,status:d,...h}=e,x=r.useId(),{root:u,wrapper:p}=Q({size:o,variant:c,status:d}),m=(0,i.B)(a,{size:o,variant:c,status:d},[q,"AlertCloseIcon"],x);return(0,s.jsx)("div",{ref:t,className:u({class:l}),...h,children:(0,s.jsx)("div",{className:p({class:n}),children:m})})});function K(e){let{size:t,variant:a,status:r,className:l,as:i}=e,{icon:n}=Q({size:t,variant:a,status:r});return(0,s.jsx)(i||"div",{className:n({class:l})})}function W(e){let{photos:t,onPhotosChange:a,nickname:l,giftId:i}=e,[n,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[h,x]=(0,r.useState)(!1),[f,j]=(0,r.useState)(null),v=async e=>{if(!i)return void j("Сначала сохраните подарок с основными данными");o(!0);try{let s=new FormData;s.append("file",e),s.append("giftId",i),s.append("fileType","hint");let r=await fetch("/api/upload",{method:"POST",body:s});if(r.ok){let{url:e}=await r.json();a({...t,hintImageUrl:e})}else j("Ошибка загрузки изображения")}catch(e){console.error("Ошибка загрузки:",e),j("Ошибка загрузки изображения")}finally{o(!1)}},y=async e=>{if(!i)return void j("Сначала сохраните подарок с основными данными");d(!0);try{let s=new FormData;s.append("file",e),s.append("giftId",i),s.append("fileType","cover");let r=await fetch("/api/upload",{method:"POST",body:s});if(r.ok){let{url:e}=await r.json();a({...t,imageCover:e})}else j("Ошибка загрузки изображения обложки")}catch(e){console.error("Ошибка загрузки:",e),j("Ошибка загрузки изображения обложки")}finally{d(!1)}},N=async e=>{if(!i)return void j("Сначала сохраните подарок с основными данными");x(!0);try{let s=new FormData;s.append("file",e),s.append("giftId",i),s.append("fileType","memory");let r=await fetch("/api/upload",{method:"POST",body:s});if(r.ok){let{url:e}=await r.json();a({...t,memoryPhoto:{...t.memoryPhoto,photoUrl:e}})}else j("Ошибка загрузки изображения")}catch(e){console.error("Ошибка загрузки:",e),j("Ошибка загрузки изображения")}finally{x(!1)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[f&&(0,s.jsxs)(G,{variant:"filled",status:"error",size:"small",children:[(0,s.jsx)(K,{as:R.sFm}),f]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{children:(0,s.jsx)("h3",{className:"mb-2 font-styrene text-paragraph-md font-bold uppercase text-text-strong-950",children:"Фотография-подсказка"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-2 flex items-center space-x-4",children:[(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&v(a)},className:"block w-full font-styrene text-paragraph-sm font-medium uppercase text-gray-500 file:mr-4 file:rounded-md file:border-0 file:px-4 file:py-2 file:font-styrene file:text-paragraph-sm file:font-medium file:uppercase",disabled:n}),n&&(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"Загрузка..."})]}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{type:"url",value:t.hintImageUrl,onChange:e=>a({...t,hintImageUrl:e.target.value}),placeholder:"Или введите URL изображения..."}),t.hintImageUrl&&(0,s.jsx)("button",{type:"button",onClick:()=>a({...t,hintImageUrl:""}),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)(b.b,{className:"block mb-2",children:"Текст подсказки"}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{id:"hintText",value:t.hintText||"",onChange:e=>a({...t,hintText:e.target.value}),placeholder:"Look for a gift with this sticker"}),t.hintText&&(0,s.jsx)("button",{type:"button",onClick:()=>a({...t,hintText:""}),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})})]}),(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsx)("h3",{className:"mb-2 font-styrene text-paragraph-md font-bold uppercase text-text-strong-950",children:"Изображение обложки (оригинал)"}),(0,s.jsxs)("div",{className:"mb-2 flex items-center space-x-4",children:[(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&y(a)},className:"block w-full font-styrene text-paragraph-sm font-medium uppercase text-gray-500 file:mr-4 file:rounded-md file:border-0 file:px-4 file:py-2 file:font-styrene file:text-paragraph-sm file:font-medium file:uppercase",disabled:c}),c&&(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"Загрузка..."})]}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{type:"url",value:t.imageCover||"",onChange:e=>a({...t,imageCover:e.target.value}),placeholder:"Или введите URL оригинального изображения..."}),t.imageCover&&(0,s.jsx)("button",{type:"button",onClick:()=>a({...t,imageCover:""}),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})})]})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{children:(0,s.jsx)("h3",{className:"mb-2 font-styrene text-paragraph-md font-bold uppercase text-text-strong-950",children:"Полароидная фотография"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-2 flex items-center space-x-4",children:[(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&N(a)},className:"block w-full font-styrene text-paragraph-sm font-medium uppercase text-gray-500 file:mr-4 file:rounded-md file:border-0 file:px-4 file:py-2 file:font-styrene file:text-paragraph-sm file:font-medium file:uppercase",disabled:h}),h&&(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"Загрузка..."})]}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{type:"url",value:t.memoryPhoto.photoUrl,onChange:e=>a({...t,memoryPhoto:{...t.memoryPhoto,photoUrl:e.target.value}}),placeholder:"Или введите URL изображения..."}),t.memoryPhoto.photoUrl&&(0,s.jsx)("button",{type:"button",onClick:()=>a({...t,memoryPhoto:{...t.memoryPhoto,photoUrl:""}}),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)(b.b,{className:"block mb-2",children:"Дата создания фотографии"}),(0,s.jsx)(u,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(m,{type:"date",value:t.memoryPhoto.photoDate||"",onChange:e=>a({...t,memoryPhoto:{...t.memoryPhoto,photoDate:e.target.value||null}}),placeholder:"Выберите дату создания фотографии"}),t.memoryPhoto.photoDate&&(0,s.jsx)("button",{type:"button",onClick:()=>a({...t,memoryPhoto:{...t.memoryPhoto,photoDate:null}}),className:"p-1",children:(0,s.jsx)(g,{as:R.Qks})})]})})]})]})]})]})]})}G.displayName="AlertRoot",K.displayName=q;var J=a(1775),X=a(3330);function Z(e){var t,a;let{gift:l,onSave:i,onCancel:n}=e,[o,c]=(0,r.useState)("basic"),[d,h]=(0,r.useState)(!1),{data:x,isLoading:u}=(0,X.RX)((null==l?void 0:l.id)||""),[p,m]=(0,r.useState)({title:(null==l?void 0:l.title)||"",author:(null==l?void 0:l.author)||"",nickname:(null==l?void 0:l.nickname)||"",number:(null==l?void 0:l.number)||0,openDate:(null==l?void 0:l.openDate)?new Date(l.openDate).toISOString().slice(0,16):"",englishDescription:(null==l?void 0:l.englishDescription)||"",hintText:(null==l?void 0:l.hintText)||"look for a gift with this sticker",codeText:(null==l?void 0:l.codeText)||"This is the part of your cipher. Collect them all to reveal the last secret",code:(null==l?void 0:l.code)||"",isSecret:(null==l?void 0:l.isSecret)||!1}),[g,f]=(0,r.useState)({blocks:[],metadata:{description:""}}),[j,b]=(0,r.useState)({hintImageUrl:(null==l?void 0:l.hintImageUrl)||"",hintText:(null==l?void 0:l.hintText)||"look for a gift with this sticker",imageCover:(null==l?void 0:l.imageCover)||"",memoryPhoto:{photoUrl:(null==l||null==(t=l.memoryPhoto)?void 0:t.photoUrl)||"",photoDate:(null==l||null==(a=l.memoryPhoto)?void 0:a.photoDate)?new Date(l.memoryPhoto.photoDate).toISOString().split("T")[0]:null}});(0,r.useEffect)(()=>{x&&f(x)},[x]);let v=async()=>{h(!0);try{let e={...p,openDate:new Date(p.openDate).toISOString(),number:Number(p.number),content:g,hintImageUrl:j.hintImageUrl,hintText:j.hintText||"look for a gift with this sticker",imageCover:j.imageCover||"",memoryPhoto:j.memoryPhoto.photoUrl?{photoUrl:j.memoryPhoto.photoUrl,photoDate:j.memoryPhoto.photoDate?new Date(j.memoryPhoto.photoDate).toISOString():null}:null};await i(e)}catch(e){console.error("Ошибка сохранения:",e)}finally{h(!1)}};return(0,s.jsxs)("div",{className:"bg-white shadow-sm rounded-lg",children:[(0,s.jsx)("div",{className:"py-0 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("nav",{className:"flex space-x-8","aria-label":"Tabs",children:[{id:"basic",name:"Основные данные"},{id:"content",name:"Контент"},{id:"memory",name:"Полароид"}].map(e=>(0,s.jsx)("button",{onClick:()=>c(e.id),className:"py-4 px-1 border-b-2 font-medium text-paragraph-md font-styrene uppercase ".concat(o===e.id?"border-bg-strong-950":"border-transparent border-b-0 text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:e.name},e.id))}),(0,s.jsxs)("div",{className:"flex space-x-6",children:[(0,s.jsx)(J.b,{onClick:n,children:"Назад"}),(0,s.jsx)(J.b,{onClick:v,disabled:d,children:d?"Сохранение...":"Сохранить"})]})]})}),(0,s.jsx)("div",{className:"p-6",children:u?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)("div",{className:"text-lg text-gray-500",children:"Загрузка..."})}):(0,s.jsxs)(s.Fragment,{children:["basic"===o&&(0,s.jsx)(S,{data:p,onChange:e=>m(e),giftId:null==l?void 0:l.id}),"content"===o&&(0,s.jsx)(_,{content:g,onChange:f,giftId:null==l?void 0:l.id}),"memory"===o&&(0,s.jsx)(W,{photos:j,onPhotosChange:b,nickname:p.nickname,giftId:null==l?void 0:l.id})]})})]})}var Y=a(285);function $(e){let{gifts:t,onCreateGift:a,onEditGift:l,onDeleteGift:i}=e,[n,o]=(0,r.useState)(""),c=t.filter(e=>{var t;return(null==(t=e.title)?void 0:t.toLowerCase().includes(n.toLowerCase()))||e.number.toString().includes(n)||e.englishDescription.toLowerCase().includes(n.toLowerCase())}),d=e=>{let t=new Date(e);return t.toLocaleDateString("ru-RU")+" "+t.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})};return(0,s.jsxs)("div",{className:"bg-transparent rounded-lg",children:[(0,s.jsx)("div",{className:"border-b border-gray-200 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h2",{className:"font-styrene text-paragraph-lg font-bold uppercase text-text-strong-950",children:["Список подарков (",t.length,")"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"text",placeholder:"Поиск",value:n,onChange:e=>o(e.target.value),className:"ring-1 ring-neutral-200 rounded-8 bg-transparent py-2 pl-2 pr-3 leading-5 placeholder-neutral-400 font-styrene placeholder:font-medium placeholder:text-paragraph-sm placeholder:uppercase"}),(0,s.jsx)(Y.b,{onClick:a,children:"Создать подарок"})]})]})}),(0,s.jsx)("div",{className:"divide-y divide-gray-200",children:0===c.length?(0,s.jsxs)("div",{className:"px-6 py-24 text-center",children:[(0,s.jsx)("h3",{className:"mt-2 text-paragraph-md font-bold text-text-strong-950 uppercase font-styrene",children:"Подарки не найдены"}),(0,s.jsx)("p",{className:"mt-2 text-paragraph-md font-styrene font-regular text-text-soft-400",children:n?"Попробуйте изменить поисковый запрос":"Начните с создания первого подарка"})]}):c.map(e=>(0,s.jsx)("div",{className:"py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"min-w-0 flex-1",children:(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)("div",{className:"min-w-0 flex-1 ",children:[(0,s.jsxs)("div",{className:"mb-1 flex items-center space-x-2",children:[(0,s.jsx)("h3",{className:"truncate text-paragraph-md font-styrene font-medium text-text-strong-950 uppercase",children:e.title||"Подарок #".concat(e.number)}),e.isSecret&&(0,s.jsx)("span",{className:"inline-flex items-center rounded bg-red-100 px-2 py-0.5 text-xs font-medium text-red-800",children:"Секретный"}),e.code&&(0,s.jsxs)("span",{className:"bg-blue-100 text-blue-800 inline-flex items-center rounded px-2 py-0.5 text-xs font-medium",children:["Код: ",e.code]})]}),(0,s.jsxs)("div",{className:"flex items-center mt-2 space-x-4 text-paragraph-sm font-styrene text-neutral-300",children:[(0,s.jsxs)("span",{children:["Открытие: ",d(e.openDate)]}),e.memoryPhoto&&(0,s.jsxs)("span",{className:"inline-flex items-center",children:[(0,s.jsx)("svg",{className:"mr-1 h-3 w-3",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}),"Полароид"]})]})]})})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{onClick:()=>l(e),className:"border-transparent focus:ring-indigo-500 inline-flex items-center rounded-md border p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2",title:"Редактировать",children:(0,s.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,s.jsx)("button",{onClick:()=>i(e.id),className:"border-transparent inline-flex items-center rounded-md border p-2 text-red-400 hover:bg-red-50 hover:text-red-500 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",title:"Удалить",children:(0,s.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},e.id))})]})}function ee(e){let{onSave:t,onCancel:a,onSuccess:l}=e,[i,n]=(0,r.useState)("basic"),[o,c]=(0,r.useState)(!1),[d,h]=(0,r.useState)(null),[x,u]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(x){let e=setTimeout(()=>{u(null)},3e3);return()=>clearTimeout(e)}},[x]);let[p,m]=(0,r.useState)({title:"",author:"",nickname:"",number:(()=>{let e=new Date(j.l$.START_DATE);return Math.ceil((new Date().getTime()-e.getTime())/864e5)})(),openDate:"",englishDescription:"",hintText:"Look for a gift with this sticker",codeText:"This is the part of your cipher. Collect them all to reveal the last secret",code:"",isSecret:!1}),[g,f]=(0,r.useState)({hintImageUrl:"",hintText:"Look for a gift with this sticker",imageCover:"",memoryPhoto:{photoUrl:"",photoDate:null}}),[b,v]=(0,r.useState)({blocks:[],metadata:{description:""}}),y=[{id:"basic",name:"Информация"},{id:"photos",name:"Фотографии"},{id:"content",name:"Контент"}],N=async()=>{let e=y.findIndex(e=>e.id===i);if(e<y.length-1){let t=y[e+1];if(t){if("basic"===i&&!d&&(await C(),x))return;n(t.id)}}},w=(0,X.Kv)(),k=(0,X.xj)(d||""),C=async()=>{c(!0);try{let e;if(!p.openDate||isNaN(new Date(p.openDate).getTime())){u("Пожалуйста, выберите корректную дату открытия"),c(!1);return}if(!p.number||p.number<=0){u("Пожалуйста, укажите корректный номер подарка"),c(!1);return}if(!p.englishDescription){u("Пожалуйста, заполните английское описание"),c(!1);return}if(!p.author){u("Пожалуйста, укажите имя друга"),c(!1);return}if(!p.nickname){u("Пожалуйста, укажите никнейм друга"),c(!1);return}try{e=new Date(p.openDate).toISOString()}catch(e){console.error("Ошибка преобразования даты:",e),u("Некорректный формат даты открытия"),c(!1);return}let t={title:p.title||"",author:p.author,nickname:p.nickname,number:Number(p.number),openDate:e,englishDescription:p.englishDescription,hintText:p.hintText||"Look for a gift with this sticker",codeText:p.codeText||"This is the part of your cipher. Collect them all to reveal the last secret",code:p.code||"",isSecret:!!p.isSecret};if(console.log("Отправляемые данные:",t),!t.openDate||!t.number||!t.englishDescription){u("Не заполнены обязательные поля: дата открытия, номер или описание"),c(!1);return}let a=await w.mutateAsync(t);console.log("Ответ сервера:",a),h(a.id)}catch(e){console.error("Ошибка сохранения:",e),u("Ошибка при сохранении подарка")}finally{c(!1)}},T=async()=>{if(d){c(!0);try{let e={...p,openDate:new Date(p.openDate).toISOString(),number:Number(p.number),hintImageUrl:g.hintImageUrl,hintText:g.hintText,imageCover:g.imageCover,content:b,memoryPhoto:g.memoryPhoto.photoUrl?{photoUrl:g.memoryPhoto.photoUrl,photoDate:g.memoryPhoto.photoDate?new Date(g.memoryPhoto.photoDate).toISOString():null}:null};if(!d)throw Error("ID подарка не указан");let a=await k.mutateAsync(e);console.log("Ответ сервера при сохранении подарка:",a),l?l():await t(a)}catch(e){console.error("Ошибка сохранения:",e),u("Ошибка при сохранении подарка: ".concat(e instanceof Error?e.message:String(e)))}finally{c(!1)}}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"rounded-lg bg-white shadow-sm",children:[(0,s.jsx)("div",{className:"border-b border-gray-200 py-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(J.b,{onClick:"basic"===i?a:()=>{let e=y.findIndex(e=>e.id===i);if(e>0){let t=y[e-1];t&&n(t.id)}},iconPosition:"start",className:"",icon:(0,s.jsx)(B.fl,{size:16,className:"rotate-180"}),children:"basic"===i?"Отменить":"Назад"}),(0,s.jsx)("nav",{className:"flex space-x-8","aria-label":"Steps",children:y.map((e,t)=>(0,s.jsx)("div",{className:"whitespace-nowrap font-styrene text-paragraph-md font-bold uppercase ".concat(i===e.id||t<y.findIndex(e=>e.id===i)?"border-adaptive text-adaptive":"border-transparent text-gray-500"),children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"mr-2",children:t+1}),e.name]})},e.id))}),(0,s.jsx)(J.b,{onClick:N,iconPosition:"end",className:"",icon:(0,s.jsx)(B.fl,{size:16}),children:"Далее"})]})}),(0,s.jsxs)("div",{className:"py-8",children:["basic"===i&&(0,s.jsx)(S,{data:p,onChange:m}),"photos"===i&&(0,s.jsx)(W,{photos:g,onPhotosChange:f,nickname:p.nickname,giftId:d||void 0}),"content"===i&&(0,s.jsx)(_,{content:b,onChange:v,giftId:d||void 0})]}),(0,s.jsx)("div",{className:"px-8 py-6",children:(0,s.jsx)("div",{className:"flex justify-center",children:"content"===i?(0,s.jsx)(Y.b,{onClick:T,disabled:o,children:o?"Сохранение...":"Сохранить подарок"}):(0,s.jsx)(Y.b,{onClick:N,disabled:"basic"===i&&!(p.openDate&&!1===isNaN(new Date(p.openDate).getTime())&&p.englishDescription&&p.number>0&&p.author&&p.nickname)||o,children:"basic"===i&&!d&&o?"Сохранение...":"Далее"})})})]}),x&&(0,s.jsx)("div",{className:"fixed bottom-6 right-6 z-50",children:(0,s.jsxs)(G,{variant:"filled",status:"error",size:"small",children:[(0,s.jsx)(K,{as:R.sFm}),x]})})]})}var et=a(2352);function ea(){let[e,t]=(0,r.useState)(null),[a,l]=(0,r.useState)(!1),[i,n]=(0,r.useState)(!1),{data:o,isLoading:c}=(0,X.Zj)(),d=(0,X.HJ)(),h=(0,X.Kv)(),x=(0,X.xj)("placeholder-id"),u=(0,r.useCallback)(async(e,t)=>{let a=await fetch("/api/gifts/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error((await a.json()).error||"Ошибка при обновлении подарка");return a.json()},[]),p=async e=>{if(confirm("Вы уверены, что хотите удалить этот подарок?"))try{await d.mutateAsync(e)}catch(e){console.error("Ошибка удаления подарка:",e),alert("Ошибка при удалении подарка")}},m=async a=>{try{if(e)e.id&&(await u(e.id,a),x.reset()),l(!1),t(null);else{let e=await h.mutateAsync(a);e&&(t(e),n(!1),l(!0))}}catch(e){console.error("Ошибка сохранения подарка:",e),alert("Ошибка при сохранении подарка: ".concat(e instanceof Error?e.message:"Неизвестная ошибка"))}};return c?(0,s.jsx)(et.l,{}):(0,s.jsx)("div",{className:"min-h-screen bg-bg-white-0",children:(0,s.jsxs)("div",{className:"container mx-auto",children:[(0,s.jsx)("div",{className:"flex justify-center pt-[100px] pb-10",children:(0,s.jsxs)("h4",{className:"text-center font-founders text-title-h4 text-text-strong-950",children:["ADMIN ",(0,s.jsx)("br",{})," PANEL"]})}),i?(0,s.jsx)(ee,{onSave:m,onCancel:()=>{n(!1)},onSuccess:()=>{n(!1)}}):a?(0,s.jsx)(Z,{gift:e,onSave:m,onCancel:()=>{l(!1),t(null)}}):(0,s.jsx)($,{gifts:o||[],onCreateGift:()=>{n(!0)},onEditGift:e=>{t(e),l(!0)},onDeleteGift:p})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[8823,6530,2960,9857,4033,4546,8441,1684,7358],()=>t(3738)),_N_E=e.O()}]);